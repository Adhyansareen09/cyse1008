(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2331],{96733:function(e,n,t){Promise.resolve().then(t.bind(t,4010))},16370:function(e,n,t){"use strict";t.d(n,{z:function(){return c}});var r=t(57437),i=t(63832),o=t(63582),s=t(46387),a=t(37183),l=t(86281);function c(e){let{sx:n,imgUrl:t,action:c,filled:d,slotProps:x,description:h,title:u="No data",...p}=e;return(0,r.jsxs)(o.Z,{flexGrow:1,alignItems:"center",justifyContent:"center",sx:{px:3,height:1,...d&&{borderRadius:2,bgcolor:e=>(0,l.jr)(e.vars.palette.grey["500Channel"],.04),border:e=>"dashed 1px ".concat((0,l.jr)(e.vars.palette.grey["500Channel"],.08))},...n},...p,children:[(0,r.jsx)(i.Z,{component:"img",alt:"empty content",src:null!=t?t:"".concat(a.CONFIG.assetsDir,"/assets/icons/empty/ic-content.svg"),sx:{width:1,maxWidth:160,...null==x?void 0:x.img}}),u&&(0,r.jsx)(s.Z,{variant:"h6",component:"span",sx:{mt:1,textAlign:"center",...null==x?void 0:x.title,color:"text.disabled"},children:u}),h&&(0,r.jsx)(s.Z,{variant:"caption",sx:{mt:1,textAlign:"center",color:"text.disabled",...null==x?void 0:x.description},children:h}),c&&c]})}},22333:function(e,n,t){"use strict";t.d(n,{ey:function(){return u},NX:function(){return j}});var r=t(57437),i=t(68032),o=t(70307),s=t(20878),a=t(49708),l=t(99341),c=t(50784),d=t(82442),x=t(63832),h=t(27250);function u(e){let{slides:n,disableZoom:t,disableVideo:x,disableTotal:u,disableCaptions:m,disableSlideshow:j,disableThumbnails:v,disableFullscreen:g,onGetCurrentIndex:f,className:b,...y}=e,Z=n?n.length:0;return(0,r.jsx)(d.ZP,{slides:n,animation:{swipe:240},carousel:{finite:Z<5},controller:{closeOnBackdropClick:!0},plugins:function(e){let{disableZoom:n,disableVideo:t,disableCaptions:r,disableSlideshow:d,disableThumbnails:x,disableFullscreen:h}=e,u=[s.Z,l.Z,a.Z,c.Z,o.Z,i.Z];return x&&(u=u.filter(e=>e!==c.Z)),r&&(u=u.filter(e=>e!==s.Z)),h&&(u=u.filter(e=>e!==l.Z)),d&&(u=u.filter(e=>e!==a.Z)),n&&(u=u.filter(e=>e!==i.Z)),t&&(u=u.filter(e=>e!==o.Z)),u}({disableZoom:t,disableVideo:x,disableCaptions:m,disableSlideshow:j,disableThumbnails:v,disableFullscreen:g}),on:{view:e=>{let{index:n}=e;f&&f(n)}},toolbar:{buttons:[(0,r.jsx)(p,{totalItems:Z,disableTotal:u},0),"close"]},render:{iconClose:()=>(0,r.jsx)(h.Ir,{width:24,icon:"carbon:close"}),iconZoomIn:()=>(0,r.jsx)(h.Ir,{width:24,icon:"carbon:zoom-in"}),iconZoomOut:()=>(0,r.jsx)(h.Ir,{width:24,icon:"carbon:zoom-out"}),iconSlideshowPlay:()=>(0,r.jsx)(h.Ir,{width:24,icon:"carbon:play"}),iconSlideshowPause:()=>(0,r.jsx)(h.Ir,{width:24,icon:"carbon:pause"}),iconPrev:()=>(0,r.jsx)(h.Ir,{width:32,icon:"carbon:chevron-left"}),iconNext:()=>(0,r.jsx)(h.Ir,{width:32,icon:"carbon:chevron-right"}),iconExitFullscreen:()=>(0,r.jsx)(h.Ir,{width:24,icon:"carbon:center-to-fit"}),iconEnterFullscreen:()=>(0,r.jsx)(h.Ir,{width:24,icon:"carbon:fit-to-screen"})},className:"mnl__lightbox__root".concat(b?" ".concat(b):""),...y})}function p(e){let{totalItems:n,disableTotal:t}=e,{currentIndex:i}=(0,d.oc)();return t?null:(0,r.jsxs)(x.Z,{component:"span",className:"yarl__button",sx:{typography:"body2",alignItems:"center",display:"inline-flex",justifyContent:"center"},children:[(0,r.jsxs)("strong",{children:[" ",i+1," "]})," / ",n]})}var m=t(2265);function j(e){let[n,t]=(0,m.useState)(-1);return{selected:n,open:n>=0,onOpen:(0,m.useCallback)(n=>{t(e.findIndex(e=>"video"===e.type?e.poster===n:e.src===n))},[e]),onClose:(0,m.useCallback)(()=>{t(-1)},[]),setSelected:t}}},47352:function(e,n,t){"use strict";t.d(n,{cv:function(){return r.DashboardContent}});var r=t(40355);t(11211)},4010:function(e,n,t){"use strict";t.r(n),t.d(n,{ChatView:function(){return eE}});var r=t(57437),i=t(2265),o=t(46387),s=t(96997),a=t(43351),l=t(37183),c=t(47352),d=t(63861),x=t(65570),h=t(30245);let u=h.Hv.chat,p={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};async function m(e,n){let t=[u,{params:{endpoint:"conversations"}}],r=[u,{params:{conversationId:e,endpoint:"conversation"}}];(0,d.JG)(r,e=>{let t=e.conversation,r={...t,messages:[...t.messages,n]};return{...e,conversation:r}},!1),(0,d.JG)(t,t=>{let r=t.conversations.map(t=>t.id===e?{...t,messages:[...t.messages,n]}:t);return{...t,conversations:r}},!1)}async function j(e){let n=[u,{params:{endpoint:"conversations"}}],t=await h.ZP.post(u,{conversationData:e});return(0,d.JG)(n,n=>{let t=[...n.conversations,e];return{...n,conversations:t}},!1),t.data}async function v(e){(0,d.JG)([u,{params:{endpoint:"conversations"}}],n=>{let t=n.conversations.map(n=>n.id===e?{...n,unreadCount:0}:n);return{...n,conversations:t}},!1)}var g=t(16370),f=t(7802),b=t(63832),y=t(63582);function Z(e){let{slots:n,sx:t,...i}=e,o=(0,r.jsx)(b.Z,{display:"flex",flexDirection:"column",children:n.nav}),s=(0,r.jsx)(y.Z,{direction:"row",alignItems:"center",sx:{py:1,pr:1,pl:2.5,height:72,flexShrink:0,borderBottom:e=>"solid 1px ".concat(e.vars.palette.divider)},children:n.header}),a=(0,r.jsx)(y.Z,{sx:{flex:"1 1 auto",minWidth:0},children:n.main}),l=(0,r.jsx)(y.Z,{sx:{minHeight:0},children:n.details});return(0,r.jsxs)(y.Z,{direction:"row",sx:t,...i,children:[o,(0,r.jsxs)(y.Z,{sx:{flex:"1 1 auto",minWidth:0},children:[s,(0,r.jsxs)(y.Z,{direction:"row",sx:{flex:"1 1 auto",minHeight:0},children:[a,l]})]})]})}var w=t(3254),C=t(77584),k=t(95576),I=t(23996),P=t(24021),S=t(97605),O=t(36469),N=t(27250),E=t(28607),R=t(16210),T=t(85422),F=t(11741);let z=(0,R.ZP)(e=>{let{selected:n,children:t,disabled:i,...o}=e;return(0,r.jsxs)(F.Z,{disabled:i,...o,children:[t,(0,r.jsx)(N.Ir,{width:16,icon:(!n||i)&&"eva:arrow-ios-forward-fill"||"eva:arrow-ios-downward-fill"})]})})(e=>{let{theme:n}=e;return{...n.typography.overline,height:40,paddingLeft:n.spacing(2.5),justifyContent:"space-between",paddingRight:n.spacing(1.5),color:n.vars.palette.text.secondary,backgroundColor:n.vars.palette.background.neutral}}),U=(0,R.ZP)(T.Z)(e=>{let{theme:n}=e;return{top:84,left:0,zIndex:9,width:32,height:32,position:"absolute",borderRadius:"0 12px 12px 0",boxShadow:n.customShadows.primary,color:n.vars.palette.primary.contrastText,backgroundColor:n.vars.palette.primary.main,transition:n.transitions.create(["all"],{duration:n.transitions.duration.shorter}),"&:hover":{backgroundColor:n.vars.palette.primary.darker}}});var W=t(59708),A=t(42409),L=t(93114),_=t(67051);function G(e){let{selected:n,collapse:t,conversation:l,onCloseMobile:c}=e,{user:d}=(0,f.E)(),x=(0,S.F)("up","md"),h=(0,a.tv)(),{group:u,displayName:p,displayText:m,participants:j,lastActivity:g,hasOnlineInGroup:Z}=function(e){let{currentUserId:n,conversation:t}=e,{messages:r,participants:i}=t,o=i.filter(e=>e.id!==n),s=r[r.length-1],a=o.length>1,l=o.map(e=>e.name).join(", "),c=!!a&&o.map(e=>e.status).includes("online"),d="";if(s){let e=s.senderId===n?"You: ":"",t="image"===s.contentType?"Sent a photo":s.body;d="".concat(e).concat(t)}return{group:a,displayName:l,displayText:d,participants:o,lastActivity:s.createdAt,hasOnlineInGroup:c}}({conversation:l,currentUserId:"".concat(null==d?void 0:d.id)}),{name:w,avatarUrl:C,status:k}=j[0],I=(0,i.useCallback)(async()=>{try{x||c(),await v(l.id),h.push("".concat(s.H.dashboard.chat,"?id=").concat(l.id))}catch(e){console.error(e)}},[l.id,x,c,h]),P=(0,r.jsx)(W.Z,{variant:Z?"online":"invisible",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(L.Z,{variant:"compact",sx:{width:48,height:48},children:j.slice(0,2).map(e=>(0,r.jsx)(A.Z,{alt:e.name,src:e.avatarUrl},e.id))})}),N=(0,r.jsx)(W.Z,{variant:k,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(A.Z,{alt:w,src:C,sx:{width:48,height:48}})},k);return(0,r.jsx)(b.Z,{component:"li",sx:{display:"flex"},children:(0,r.jsxs)(F.Z,{onClick:I,sx:{py:1.5,px:2.5,gap:2,...n&&{bgcolor:"action.selected"}},children:[(0,r.jsx)(W.Z,{color:"error",overlap:"circular",badgeContent:t?l.unreadCount:0,children:u?P:N}),!t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.Z,{primary:p,primaryTypographyProps:{noWrap:!0,component:"span",variant:"subtitle2"},secondary:m,secondaryTypographyProps:{noWrap:!0,component:"span",variant:l.unreadCount?"subtitle2":"body2",color:l.unreadCount?"text.primary":"text.secondary"}}),(0,r.jsxs)(y.Z,{alignItems:"flex-end",sx:{alignSelf:"stretch"},children:[(0,r.jsx)(o.Z,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:(0,O.DY)(g)}),!!l.unreadCount&&(0,r.jsx)(b.Z,{sx:{width:8,height:8,bgcolor:"info.main",borderRadius:"50%"}})]})]})]})})}var D=t(33833),H=t(8350),q=t(71969),M=t(35108),V=t(50290),B=t(53588),J=t(41327),Y=t(83653),X=t(71721),K=t(92548);function Q(){var e;let{user:n}=(0,f.E)(),t=(0,K.S)(),[o,s]=(0,i.useState)("online"),a=(0,i.useCallback)(e=>{s(e.target.value)},[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(W.Z,{variant:o,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(A.Z,{src:null==n?void 0:n.photoURL,alt:null==n?void 0:n.displayName,onClick:t.onOpen,sx:{cursor:"pointer",width:48,height:48},children:null==n?void 0:null===(e=n.displayName)||void 0===e?void 0:e.charAt(0).toUpperCase()})}),(0,r.jsxs)(K.m,{open:t.open,anchorEl:t.anchorEl,onClose:t.onClose,slotProps:{paper:{sx:{p:0}},arrow:{placement:"top-left"}},children:[(0,r.jsxs)(y.Z,{direction:"row",alignItems:"center",spacing:2,sx:{py:2,pr:1,pl:2},children:[(0,r.jsx)(_.Z,{primary:null==n?void 0:n.displayName,secondary:null==n?void 0:n.email,secondaryTypographyProps:{component:"span"}}),(0,r.jsx)(q.Z,{title:"Log out",children:(0,r.jsx)(k.Z,{color:"error",children:(0,r.jsx)(N.Ir,{icon:"ic:round-power-settings-new"})})})]}),(0,r.jsx)(H.Z,{sx:{borderStyle:"dashed"}}),(0,r.jsxs)(M.Z,{sx:{my:.5,px:.5},children:[(0,r.jsxs)(V.Z,{children:[(0,r.jsx)(W.Z,{variant:o,sx:{["& .".concat(X.Z.badge)]:{m:.75,width:12,height:12,flexShrink:0,position:"static"}}}),(0,r.jsx)(J.Z,{fullWidth:!0,children:(0,r.jsx)(D.Z,{native:!0,fullWidth:!0,value:o,onChange:a,input:(0,r.jsx)(B.ZP,{}),inputProps:{id:"chat-status-select",sx:{textTransform:"capitalize"}},sx:{["& .".concat(Y.Z.root)]:{right:0}},children:["online","alway","busy","offline"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})})]}),(0,r.jsxs)(V.Z,{children:[(0,r.jsx)(N.Ir,{icon:"solar:user-id-bold",width:24}),"Profile"]}),(0,r.jsxs)(V.Z,{children:[(0,r.jsx)(N.Ir,{icon:"eva:settings-2-fill",width:24}),"Settings"]})]})]})]})}var $=t(82480),ee=t(73053);function en(e){let{sx:n,amount:t=6,...i}=e;return[...Array(t)].map((e,t)=>(0,r.jsxs)(y.Z,{spacing:2,direction:"row",alignItems:"center",sx:{px:2.5,py:1.5,...n},...i,children:[(0,r.jsx)($.Z,{variant:"circular",sx:{width:48,height:48}}),(0,r.jsxs)(y.Z,{spacing:1,flexGrow:1,children:[(0,r.jsx)($.Z,{sx:{width:.75,height:10}}),(0,r.jsx)($.Z,{sx:{width:.5,height:10}})]})]},t))}function et(e){let{sx:n,...t}=e;return(0,r.jsxs)(y.Z,{direction:"row",alignItems:"center",sx:{width:1,...n},...t,children:[(0,r.jsx)($.Z,{variant:"circular",sx:{width:40,height:40}}),(0,r.jsxs)(y.Z,{spacing:1,flexGrow:1,sx:{mx:2},children:[(0,r.jsx)($.Z,{sx:{width:96,height:10}}),(0,r.jsx)($.Z,{sx:{width:40,height:10}})]}),(0,r.jsx)($.Z,{variant:"circular",sx:{width:28,height:28}}),(0,r.jsx)($.Z,{variant:"circular",sx:{width:28,height:28,mx:1}}),(0,r.jsx)($.Z,{variant:"circular",sx:{width:28,height:28,mr:1}})]})}function er(e){let{sx:n,...t}=e;return(0,r.jsx)(y.Z,{flexGrow:1,sx:{pt:5,...n},...t,children:(0,r.jsxs)(y.Z,{alignItems:"center",children:[(0,r.jsx)($.Z,{variant:"circular",sx:{width:96,height:96}}),(0,r.jsx)($.Z,{sx:{mb:1,mt:2,height:10,width:.65}}),(0,r.jsx)($.Z,{sx:{width:.35,height:10,mb:5}}),(0,r.jsx)(ee.Z,{color:"inherit",thickness:2})]})})}var ei=t(77057);function eo(e){let{query:n,results:t,onClickResult:i}=e,s=t.length,a=!s&&!!n,l=(0,r.jsx)(ei.N,{query:n,sx:{p:3,mx:"auto",width:"calc(100% - 40px)",bgcolor:"background.neutral"}}),c=(0,r.jsx)("nav",{children:(0,r.jsx)(b.Z,{component:"ul",children:t.map(e=>(0,r.jsx)(b.Z,{component:"li",sx:{display:"flex"},children:(0,r.jsxs)(F.Z,{onClick:()=>i(e),sx:{gap:2,py:1.5,px:2.5,typography:"subtitle2"},children:[(0,r.jsx)(A.Z,{alt:e.name,src:e.avatarUrl}),e.name]})},e.id))})});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.Z,{variant:"h6",sx:{px:2.5,mb:2},children:["Contacts (",s,")"]}),a?l:c]})}var es=t(63593);function ea(e){var n;let{message:t="",recipients:r,me:i}=e,o=r.length>1,s={id:(0,es.k)(),attachments:[],body:t,contentType:"text",createdAt:(0,O.qo)({minutes:1}),senderId:i.id},a={id:o?(0,es.k)():null===(n=r[0])||void 0===n?void 0:n.id,messages:[s],participants:[...r,i],type:o?"GROUP":"ONE_TO_ONE",unreadCount:0};return{messageData:s,conversationData:a}}function el(e){let{loading:n,contacts:t,collapseNav:o,conversations:l,selectedConversationId:c}=e,d=(0,a.tv)(),x=(0,S.F)("up","md"),{user:h}=(0,f.E)(),{openMobile:u,onOpenMobile:p,onCloseMobile:m,onCloseDesktop:v,collapseDesktop:g,onCollapseDesktop:Z}=o,[R,T]=(0,i.useState)({query:"",results:[]}),F=(0,i.useMemo)(()=>({id:"".concat(null==h?void 0:h.id),role:"".concat(null==h?void 0:h.role),email:"".concat(null==h?void 0:h.email),address:"".concat(null==h?void 0:h.address),name:"".concat(null==h?void 0:h.displayName),lastActivity:(0,O.Lg)(),avatarUrl:"".concat(null==h?void 0:h.photoURL),phoneNumber:"".concat(null==h?void 0:h.phoneNumber),status:"online"}),[h]);(0,i.useEffect)(()=>{x||v()},[v,x]);let z=(0,i.useCallback)(()=>{x?Z():m()},[x,m,Z]),W=(0,i.useCallback)(()=>{x||m(),d.push(s.H.dashboard.chat)},[x,m,d]),A=(0,i.useCallback)(e=>{if(T(n=>({...n,query:e})),e){let n=t.filter(n=>n.name.toLowerCase().includes(e));T(e=>({...e,results:n}))}},[t]),L=(0,i.useCallback)(()=>{T({query:"",results:[]})},[]),_=(0,i.useCallback)(async e=>{L();let n=e=>d.push("".concat(s.H.dashboard.chat,"?id=").concat(e));try{if(l.allIds.includes(e.id)){n(e.id);return}let r=t.find(n=>n.id===e.id);if(!r){console.error("Recipient not found");return}let{conversationData:i}=ea({recipients:[r],me:F}),o=await j(i);o&&o.conversation||console.error("Failed to create conversation"),n(o.conversation.id)}catch(e){console.error("Error handling click result:",e)}},[t,l.allIds,L,F,d]),D=(0,r.jsx)(en,{}),H=(0,r.jsx)("nav",{children:(0,r.jsx)(b.Z,{component:"ul",children:l.allIds.map(e=>(0,r.jsx)(G,{collapse:g,conversation:l.byId[e],selected:e===c,onCloseMobile:m},e))})}),q=(0,r.jsx)(eo,{query:R.query,results:R.results,onClickResult:_}),M=(0,r.jsx)(P.d,{onClickAway:L,children:(0,r.jsx)(C.Z,{fullWidth:!0,value:R.query,onChange:e=>A(e.target.value),placeholder:"Search contacts...",InputProps:{startAdornment:(0,r.jsx)(I.Z,{position:"start",children:(0,r.jsx)(N.Ir,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})},sx:{mt:2.5}})}),V=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(y.Z,{direction:"row",alignItems:"center",justifyContent:"center",sx:{p:2.5,pb:0},children:[!g&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q,{}),(0,r.jsx)(b.Z,{sx:{flexGrow:1}})]}),(0,r.jsx)(k.Z,{onClick:z,children:(0,r.jsx)(N.Ir,{icon:g?"eva:arrow-ios-forward-fill":"eva:arrow-ios-back-fill"})}),!g&&(0,r.jsx)(k.Z,{onClick:W,children:(0,r.jsx)(N.Ir,{width:24,icon:"solar:user-plus-bold"})})]}),(0,r.jsx)(b.Z,{sx:{p:2.5,pt:0},children:!g&&M}),n?D:(0,r.jsx)(E.L,{sx:{pb:1},children:R.query&&l.allIds.length?q:H})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U,{onClick:p,sx:{display:{md:"none"}},children:(0,r.jsx)(N.Ir,{width:16,icon:"solar:users-group-rounded-bold"})}),(0,r.jsx)(y.Z,{sx:{minHeight:0,flex:"1 1 auto",width:320,display:{xs:"none",md:"flex"},borderRight:e=>"solid 1px ".concat(e.vars.palette.divider),transition:e=>e.transitions.create(["width"],{duration:e.transitions.duration.shorter}),...g&&{width:96}},children:V}),(0,r.jsx)(w.ZP,{open:u,onClose:m,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:V})]})}var ec=t(17162),ed=t(23857),ex=t(35791),eh=t(77468),eu=t(86281);function ep(e){let{participant:n,open:t,onClose:i}=e;return(0,r.jsxs)(ex.Z,{fullWidth:!0,maxWidth:"xs",open:t,onClose:i,children:[(0,r.jsx)(k.Z,{onClick:i,sx:{position:"absolute",right:8,top:8},children:(0,r.jsx)(N.Ir,{icon:"mingcute:close-line"})}),(0,r.jsxs)(eh.Z,{sx:{py:5,px:3,display:"flex"},children:[(0,r.jsx)(A.Z,{alt:n.name,src:n.avatarUrl,sx:{width:96,height:96,mr:3}}),(0,r.jsxs)(y.Z,{spacing:1,children:[(0,r.jsx)(o.Z,{variant:"caption",sx:{color:"primary.main"},children:n.role}),(0,r.jsx)(o.Z,{variant:"subtitle1",children:n.name}),(0,r.jsxs)(y.Z,{direction:"row",sx:{typography:"caption",color:"text.disabled"},children:[(0,r.jsx)(N.Ir,{icon:"mingcute:location-fill",width:16,sx:{flexShrink:0,mr:.5,mt:"2px"}}),n.address]}),(0,r.jsxs)(y.Z,{spacing:1,direction:"row",sx:{pt:1.5},children:[(0,r.jsx)(k.Z,{size:"small",color:"error",sx:{borderRadius:1,bgcolor:e=>(0,eu.jr)(e.vars.palette.error.mainChannel,.08),"&:hover":{bgcolor:e=>(0,eu.jr)(e.vars.palette.error.mainChannel,.16)}},children:(0,r.jsx)(N.Ir,{width:18,icon:"solar:phone-bold"})}),(0,r.jsx)(k.Z,{size:"small",color:"info",sx:{borderRadius:1,bgcolor:e=>(0,eu.jr)(e.vars.palette.info.mainChannel,.08),"&:hover":{bgcolor:e=>(0,eu.jr)(e.vars.palette.info.mainChannel,.16)}},children:(0,r.jsx)(N.Ir,{width:18,icon:"solar:chat-round-dots-bold"})}),(0,r.jsx)(k.Z,{size:"small",color:"primary",sx:{borderRadius:1,bgcolor:e=>(0,eu.jr)(e.vars.palette.primary.mainChannel,.08),"&:hover":{bgcolor:e=>(0,eu.jr)(e.vars.palette.primary.mainChannel,.16)}},children:(0,r.jsx)(N.Ir,{width:18,icon:"fluent:mail-24-filled"})}),(0,r.jsx)(k.Z,{size:"small",color:"secondary",sx:{borderRadius:1,bgcolor:e=>(0,eu.jr)(e.vars.palette.secondary.mainChannel,.08),"&:hover":{bgcolor:e=>(0,eu.jr)(e.vars.palette.secondary.mainChannel,.16)}},children:(0,r.jsx)(N.Ir,{width:18,icon:"solar:videocamera-record-bold"})})]})]})]})]})}function em(e){let{participants:n}=e,t=(0,ed.k)(!0),[o,s]=(0,i.useState)(null),a=(0,i.useCallback)(e=>{s(e)},[]),l=(0,i.useCallback)(()=>{s(null)},[]),c=n.length,d=(0,r.jsx)(r.Fragment,{children:n.map(e=>(0,r.jsxs)(F.Z,{onClick:()=>a(e),children:[(0,r.jsx)(W.Z,{variant:e.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(A.Z,{alt:e.name,src:e.avatarUrl})}),(0,r.jsx)(_.Z,{sx:{ml:2},primary:e.name,secondary:e.role,primaryTypographyProps:{noWrap:!0,typography:"subtitle2"},secondaryTypographyProps:{noWrap:!0,component:"span",typography:"caption"}})]},e.id))});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z,{selected:t.value,disabled:!c,onClick:t.onToggle,children:"In room (".concat(c,")")}),(0,r.jsx)(ec.Z,{in:t.value,children:d}),o&&(0,r.jsx)(ep,{participant:o,open:!!o,onClose:l})]})}function ej(e){let{participant:n}=e,t=(0,ed.k)(!0),i=(0,r.jsxs)(y.Z,{alignItems:"center",sx:{py:5},children:[(0,r.jsx)(A.Z,{alt:null==n?void 0:n.name,src:null==n?void 0:n.avatarUrl,sx:{width:96,height:96,mb:2}}),(0,r.jsx)(o.Z,{variant:"subtitle1",children:null==n?void 0:n.name}),(0,r.jsx)(o.Z,{variant:"body2",sx:{color:"text.secondary",mt:.5},children:null==n?void 0:n.role})]}),s=(0,r.jsx)(y.Z,{spacing:2,sx:{px:2,py:2.5},children:[{icon:"mingcute:location-fill",value:null==n?void 0:n.address},{icon:"solar:phone-bold",value:null==n?void 0:n.phoneNumber},{icon:"fluent:mail-24-filled",value:null==n?void 0:n.email}].map(e=>(0,r.jsxs)(y.Z,{spacing:1,direction:"row",sx:{typography:"body2",wordBreak:"break-all"},children:[(0,r.jsx)(N.Ir,{icon:e.icon,sx:{flexShrink:0,color:"text.disabled"}}),e.value]},e.icon))});return(0,r.jsxs)(r.Fragment,{children:[i,(0,r.jsx)(z,{selected:t.value,onClick:t.onToggle,children:"Information"}),(0,r.jsx)(ec.Z,{in:t.value,children:s})]})}var ev=t(43857);function eg(e){let{attachments:n}=e,t=(0,ed.k)(!0),i=n.length,o=n.map((e,n)=>(0,r.jsxs)(y.Z,{spacing:1.5,direction:"row",alignItems:"center",children:[(0,r.jsx)(ev.mB,{imageView:!0,file:e.preview,onDownload:()=>console.info("DOWNLOAD"),slotProps:{icon:{width:24,height:24}},sx:{width:40,height:40,bgcolor:"background.neutral"}}),(0,r.jsx)(_.Z,{primary:e.name,secondary:(0,O.zM)(e.createdAt),primaryTypographyProps:{noWrap:!0,typography:"body2"},secondaryTypographyProps:{mt:.25,noWrap:!0,component:"span",typography:"caption",color:"text.disabled"}})]},e.name+n));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z,{selected:t.value,disabled:!i,onClick:t.onToggle,children:"Attachments (".concat(i,")")}),!!i&&(0,r.jsx)(ec.Z,{in:t.value,children:(0,r.jsx)(y.Z,{spacing:2,sx:{p:2},children:o})})]})}function ef(e){let{collapseNav:n,participants:t,messages:i,loading:o}=e,{collapseDesktop:s,openMobile:a,onCloseMobile:l}=n,c=t.length>1,d=i.map(e=>e.attachments).flat(1)||[],x=o?(0,r.jsx)(er,{}):(0,r.jsx)(E.L,{children:(0,r.jsxs)("div",{children:[c?(0,r.jsx)(em,{participants:t}):(0,r.jsx)(ej,{participant:t[0]}),(0,r.jsx)(eg,{attachments:d})]})});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.Z,{sx:{minHeight:0,flex:"1 1 auto",width:280,display:{xs:"none",lg:"flex"},borderLeft:e=>"solid 1px ".concat(e.vars.palette.divider),transition:e=>e.transitions.create(["width"],{duration:e.transitions.duration.shorter}),...s&&{width:0}},children:!s&&x}),(0,r.jsx)(w.ZP,{anchor:"right",open:a,onClose:l,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:x})]})}var eb=t(5186),ey=t(22333);function eZ(e){let{message:n,participants:t,onOpenLightbox:i}=e,{user:s}=(0,f.E)(),{me:a,senderDetails:l,hasImage:c}=function(e){let{message:n,participants:t,currentUserId:r}=e,i=t.find(e=>e.id===n.senderId),o=n.senderId===r?{type:"me"}:{avatarUrl:null==i?void 0:i.avatarUrl,firstName:null==i?void 0:i.name.split(" ")[0]},s="me"===o.type;return{hasImage:"image"===n.contentType,me:s,senderDetails:o}}({message:n,participants:t,currentUserId:"".concat(null==s?void 0:s.id)}),{firstName:d,avatarUrl:x}=l,{body:h,createdAt:u}=n,p=(0,r.jsxs)(o.Z,{noWrap:!0,variant:"caption",sx:{mb:1,color:"text.disabled",...!a&&{mr:"auto"}},children:[!a&&"".concat(d,", "),(0,O.DY)(u)]}),m=(0,r.jsx)(y.Z,{sx:{p:1.5,minWidth:48,maxWidth:320,borderRadius:1,typography:"body2",bgcolor:"background.neutral",...a&&{color:"grey.800",bgcolor:"primary.lighter"},...c&&{p:0,bgcolor:"transparent"}},children:c?(0,r.jsx)(b.Z,{component:"img",alt:"attachment",src:h,onClick:()=>i(h),sx:{width:400,height:"auto",borderRadius:1.5,cursor:"pointer",objectFit:"cover",aspectRatio:"16/11","&:hover":{opacity:.9}}}):h}),j=(0,r.jsxs)(y.Z,{direction:"row",className:"message-actions",sx:{pt:.5,left:0,opacity:0,top:"100%",position:"absolute",transition:e=>e.transitions.create(["opacity"],{duration:e.transitions.duration.shorter}),...a&&{right:0,left:"unset"}},children:[(0,r.jsx)(k.Z,{size:"small",children:(0,r.jsx)(N.Ir,{icon:"solar:reply-bold",width:16})}),(0,r.jsx)(k.Z,{size:"small",children:(0,r.jsx)(N.Ir,{icon:"eva:smiling-face-fill",width:16})}),(0,r.jsx)(k.Z,{size:"small",children:(0,r.jsx)(N.Ir,{icon:"solar:trash-bin-trash-bold",width:16})})]});return n.body?(0,r.jsxs)(y.Z,{direction:"row",justifyContent:a?"flex-end":"unset",sx:{mb:5},children:[!a&&(0,r.jsx)(A.Z,{alt:d,src:x,sx:{width:32,height:32,mr:2}}),(0,r.jsxs)(y.Z,{alignItems:a?"flex-end":"flex-start",children:[p,(0,r.jsxs)(y.Z,{direction:"row",alignItems:"center",sx:{position:"relative","&:hover":{"& .message-actions":{opacity:1}}},children:[m,j]})]})]}):null}function ew(e){let{messages:n=[],participants:t,loading:o}=e,{messagesEndRef:s}=function(e){let n=(0,i.useRef)(null),t=(0,i.useCallback)(()=>{e&&n.current&&n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]);return(0,i.useEffect)(()=>{t()},[e]),{messagesEndRef:n}}(n),a=n.filter(e=>"image"===e.contentType).map(e=>({src:e.body})),l=(0,ey.NX)(a);return o?(0,r.jsx)(y.Z,{sx:{flex:"1 1 auto",position:"relative"},children:(0,r.jsx)(eb.Z,{color:"inherit",sx:{top:0,left:0,width:1,height:2,borderRadius:0,position:"absolute"}})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.L,{ref:s,sx:{px:3,pt:5,pb:3,flex:"1 1 auto"},children:n.map(e=>(0,r.jsx)(eZ,{message:e,participants:t,onOpenLightbox:()=>l.onOpen(e.body)},e.id))}),(0,r.jsx)(ey.ey,{slides:a,open:l.open,close:l.onClose,index:l.selected})]})}function eC(e){let{disabled:n,recipients:t,onAddRecipients:o,selectedConversationId:l}=e,c=(0,a.tv)(),{user:d}=(0,f.E)(),x=(0,i.useRef)(null),[h,u]=(0,i.useState)(""),{messageData:p,conversationData:v}=ea({message:h,recipients:t,me:(0,i.useMemo)(()=>({id:"".concat(null==d?void 0:d.id),role:"".concat(null==d?void 0:d.role),email:"".concat(null==d?void 0:d.email),address:"".concat(null==d?void 0:d.address),name:"".concat(null==d?void 0:d.displayName),lastActivity:(0,O.Lg)(),avatarUrl:"".concat(null==d?void 0:d.photoURL),phoneNumber:"".concat(null==d?void 0:d.phoneNumber),status:"online"}),[d])}),g=(0,i.useCallback)(()=>{x.current&&x.current.click()},[]),b=(0,i.useCallback)(e=>{u(e.target.value)},[]),Z=(0,i.useCallback)(async e=>{if("Enter"===e.key&&h)try{if(l)await m(l,p);else{let e=await j(v);c.push("".concat(s.H.dashboard.chat,"?id=").concat(e.conversation.id)),o([])}}catch(e){console.error(e)}finally{u("")}},[v,h,p,o,c,l]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.ZP,{name:"chat-message",id:"chat-message-input",value:h,onKeyUp:Z,onChange:b,placeholder:"Type a message",disabled:n,startAdornment:(0,r.jsx)(k.Z,{children:(0,r.jsx)(N.Ir,{icon:"eva:smiling-face-fill"})}),endAdornment:(0,r.jsxs)(y.Z,{direction:"row",sx:{flexShrink:0},children:[(0,r.jsx)(k.Z,{onClick:g,children:(0,r.jsx)(N.Ir,{icon:"solar:gallery-add-bold"})}),(0,r.jsx)(k.Z,{onClick:g,children:(0,r.jsx)(N.Ir,{icon:"eva:attach-2-fill"})}),(0,r.jsx)(k.Z,{children:(0,r.jsx)(N.Ir,{icon:"solar:microphone-bold"})})]}),sx:{px:1,height:56,flexShrink:0,borderTop:e=>"solid 1px ".concat(e.vars.palette.divider)}}),(0,r.jsx)("input",{type:"file",ref:x,style:{display:"none"}})]})}var ek=t(56490);function eI(e){let{collapseNav:n,participants:t,loading:o}=e,s=(0,K.S)(),a=(0,S.F)("up","lg"),l=t.length>1,c=t[0],{collapseDesktop:d,onCollapseDesktop:x,onOpenMobile:h}=n,u=(0,i.useCallback)(()=>{a?x():h()},[a]),p=(0,r.jsx)(L.Z,{max:3,sx:{["& .".concat(ek.Z.avatar)]:{width:32,height:32}},children:t.map(e=>(0,r.jsx)(A.Z,{alt:e.name,src:e.avatarUrl},e.id))}),m=(0,r.jsxs)(y.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,r.jsx)(W.Z,{variant:null==c?void 0:c.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(A.Z,{src:null==c?void 0:c.avatarUrl,alt:null==c?void 0:c.name})}),(0,r.jsx)(_.Z,{primary:null==c?void 0:c.name,secondary:(null==c?void 0:c.status)==="offline"?(0,O.DY)(null==c?void 0:c.lastActivity):null==c?void 0:c.status,secondaryTypographyProps:{component:"span",...(null==c?void 0:c.status)!=="offline"&&{textTransform:"capitalize"}}})]});return o?(0,r.jsx)(et,{}):(0,r.jsxs)(r.Fragment,{children:[l?p:m,(0,r.jsxs)(y.Z,{direction:"row",flexGrow:1,justifyContent:"flex-end",children:[(0,r.jsx)(k.Z,{children:(0,r.jsx)(N.Ir,{icon:"solar:phone-bold"})}),(0,r.jsx)(k.Z,{children:(0,r.jsx)(N.Ir,{icon:"solar:videocamera-record-bold"})}),(0,r.jsx)(k.Z,{onClick:u,children:(0,r.jsx)(N.Ir,{icon:d?"ri:sidebar-fold-fill":"ri:sidebar-unfold-fill"})}),(0,r.jsx)(k.Z,{onClick:s.onOpen,children:(0,r.jsx)(N.Ir,{icon:"eva:more-vertical-fill"})})]}),(0,r.jsx)(K.m,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,children:(0,r.jsxs)(M.Z,{children:[(0,r.jsxs)(V.Z,{onClick:()=>{s.onClose()},children:[(0,r.jsx)(N.Ir,{icon:"solar:bell-off-bold"}),"Hide notifications"]}),(0,r.jsxs)(V.Z,{onClick:()=>{s.onClose()},children:[(0,r.jsx)(N.Ir,{icon:"solar:forbidden-circle-bold"}),"Block"]}),(0,r.jsxs)(V.Z,{onClick:()=>{s.onClose()},children:[(0,r.jsx)(N.Ir,{icon:"solar:danger-triangle-bold"}),"Report"]}),(0,r.jsx)(H.Z,{sx:{borderStyle:"dashed"}}),(0,r.jsxs)(V.Z,{onClick:()=>{s.onClose()},sx:{color:"error.main"},children:[(0,r.jsx)(N.Ir,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}var eP=t(89902),eS=t(37685);function eO(e){let{contacts:n,onAddRecipients:t}=e,[s,a]=(0,i.useState)(""),l=(0,i.useCallback)(e=>{a(""),t(e)},[t]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{variant:"subtitle2",sx:{color:"text.primary",mr:2},children:"To:"}),(0,r.jsx)(eS.Z,{sx:{minWidth:{md:320},flexGrow:{xs:1,md:"unset"}},multiple:!0,limitTags:3,popupIcon:null,defaultValue:[],disableCloseOnSelect:!0,noOptionsText:(0,r.jsx)(ei.N,{query:s}),onChange:(e,n)=>l(n),onInputChange:(e,n)=>a(n),options:n,getOptionLabel:e=>e.name,isOptionEqualToValue:(e,n)=>e.id===n.id,renderInput:e=>(0,r.jsx)(C.Z,{...e,placeholder:"+ Recipients"}),renderOption:(e,n,t)=>{let{selected:o}=t;return(0,i.createElement)("li",{...e,key:n.id,children:[(0,r.jsxs)(b.Z,{sx:{mr:1,width:32,height:32,overflow:"hidden",borderRadius:"50%",position:"relative"},children:[(0,r.jsx)(A.Z,{alt:n.name,src:n.avatarUrl,sx:{width:1,height:1}}),(0,r.jsx)(y.Z,{alignItems:"center",justifyContent:"center",sx:{top:0,left:0,width:1,height:1,opacity:0,position:"absolute",bgcolor:e=>(0,eu.jr)(e.vars.palette.grey["900Channel"],.8),transition:e=>e.transitions.create(["opacity"],{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.shorter}),...o&&{opacity:1,color:"primary.main"}},children:(0,r.jsx)(N.Ir,{icon:"eva:checkmark-fill"})})]},n.id),n.name]})},renderTags:(e,n)=>e.map((e,t)=>(0,i.createElement)(eP.Z,{...n({index:t}),key:e.id,label:e.name,avatar:(0,r.jsx)(A.Z,{alt:e.name,src:e.avatarUrl}),size:"small",variant:"soft"}))})]})}function eN(){let[e,n]=(0,i.useState)(!1),[t,r]=(0,i.useState)(!1),o=(0,i.useCallback)(()=>{r(e=>!e)},[]);return{collapseDesktop:t,onCloseDesktop:(0,i.useCallback)(()=>{r(!1)},[]),onCollapseDesktop:o,openMobile:e,onOpenMobile:(0,i.useCallback)(()=>{n(!0)},[]),onCloseMobile:(0,i.useCallback)(()=>{n(!1)},[])}}function eE(){var e,n;let t=(0,a.tv)(),{user:m}=(0,f.E)(),{contacts:j}=function(){let e=[u,{params:{endpoint:"contacts"}}],{data:n,isLoading:t,error:r,isValidating:o}=(0,d.ZP)(e,h._i,p);return(0,i.useMemo)(()=>({contacts:(null==n?void 0:n.contacts)||[],contactsLoading:t,contactsError:r,contactsValidating:o,contactsEmpty:!t&&!(null==n?void 0:n.contacts.length)}),[null==n?void 0:n.contacts,r,t,o])}(),v=(0,a.lr)().get("id")||"",[b,y]=(0,i.useState)([]),{conversations:w,conversationsLoading:C}=function(){let e=[u,{params:{endpoint:"conversations"}}],{data:n,isLoading:t,error:r,isValidating:o}=(0,d.ZP)(e,h._i,p);return(0,i.useMemo)(()=>{let e=(null==n?void 0:n.conversations.length)?(0,x.VS)(n.conversations,"id"):{},i=Object.keys(e);return{conversations:{byId:e,allIds:i},conversationsLoading:t,conversationsError:r,conversationsValidating:o,conversationsEmpty:!t&&!i.length}},[null==n?void 0:n.conversations,r,t,o])}(),{conversation:k,conversationError:I,conversationLoading:P}=function(e){let n=e?[u,{params:{conversationId:e,endpoint:"conversation"}}]:"",{data:t,isLoading:r,error:o,isValidating:s}=(0,d.ZP)(n,h._i,p);return(0,i.useMemo)(()=>({conversation:null==t?void 0:t.conversation,conversationLoading:r,conversationError:o,conversationValidating:s}),[null==t?void 0:t.conversation,o,r,s])}("".concat(v)),S=eN(),O=eN(),N=k?k.participants.filter(e=>e.id!=="".concat(null==m?void 0:m.id)):[];(0,i.useEffect)(()=>{(I||!v)&&t.push(s.H.dashboard.chat)},[I,t,v]);let E=(0,i.useCallback)(e=>{y(e)},[]);return(0,r.jsxs)(c.cv,{maxWidth:!1,sx:{display:"flex",flex:"1 1 auto",flexDirection:"column"},children:[(0,r.jsx)(o.Z,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Chat"}),(0,r.jsx)(Z,{sx:{minHeight:0,flex:"1 1 0",borderRadius:2,position:"relative",bgcolor:"background.paper",boxShadow:e=>e.customShadows.card},slots:{header:v?(0,r.jsx)(eI,{collapseNav:S,participants:N,loading:P}):(0,r.jsx)(eO,{contacts:j,onAddRecipients:E}),nav:(0,r.jsx)(el,{contacts:j,conversations:w,loading:C,selectedConversationId:v,collapseNav:O}),main:(0,r.jsxs)(r.Fragment,{children:[v?(0,r.jsx)(ew,{messages:null!==(e=null==k?void 0:k.messages)&&void 0!==e?e:[],participants:N,loading:P}):(0,r.jsx)(g.z,{imgUrl:"".concat(l.CONFIG.assetsDir,"/assets/icons/empty/ic-chat-active.svg"),title:"Good morning!",description:"Write something awesome..."}),(0,r.jsx)(eC,{recipients:b,onAddRecipients:E,selectedConversationId:v,disabled:!b.length&&!v})]}),details:v&&(0,r.jsx)(ef,{collapseNav:S,participants:N,loading:P,messages:null!==(n=null==k?void 0:k.messages)&&void 0!==n?n:[]})}})]})}},63593:function(e,n,t){"use strict";function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)})}t.d(n,{k:function(){return r}})}},function(e){e.O(0,[4358,8691,8331,9271,7648,1021,8489,4591,334,1725,1969,7e3,4412,6112,8398,9708,3588,5147,7618,3155,9621,3833,2175,2800,5318,8770,2171,3464,9867,7685,6676,3777,9881,5074,3538,2458,3861,7587,6281,2407,8295,1315,9117,8192,1211,2971,2117,1744],function(){return e(e.s=96733)}),_N_E=e.O()}]);